<!-- =============================================== -->
<!-- FICHIER: views/login.ejs -->
<!-- =============================================== -->
<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Connexion - Soakoja</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .login-container {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 400px;
    }

    .logo {
      text-align: center;
      margin-bottom: 2rem;
    }

    .logo h1 {
      color: #333;
      margin: 0;
      font-size: 2rem;
    }

    .logo p {
      color: #666;
      margin: 0.5rem 0 0 0;
      font-size: 0.9rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      color: #333;
      font-weight: bold;
    }

    input[type="text"],
    input[type="password"] {
      width: 100%;
      padding: 0.8rem;
      border: 2px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
      box-sizing: border-box;
    }

    input[type="text"]:focus,
    input[type="password"]:focus {
      outline: none;
      border-color: #667eea;
    }

    .btn {
      width: 100%;
      padding: 0.8rem;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .btn:hover {
      transform: translateY(-2px);
    }

    .error {
      background: #fee;
      color: #c33;
      padding: 0.8rem;
      border-radius: 5px;
      margin-bottom: 1rem;
      border-left: 4px solid #c33;
    }

    .test-accounts {
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px solid #eee;
      font-size: 0.85rem;
      color: #666;
    }

    .test-accounts h4 {
      margin: 0 0 0.5rem 0;
      color: #333;
    }
  </style>
</head>

<body>
  <div class="login-container">
    <div class="logo">
      <h1>üö∞ SOAKOJA</h1>
      <p>Gestion Eau Potable - Madagascar</p>
    </div>

    <% if (error) { %>
      <div class="error">
        <%= error %>
      </div>
      <% } %>

        <form method="POST" action="/login">
          <div class="form-group">
            <label for="surnom">Nom d'utilisateur (surnom):</label>
            <input type="text" id="surnom" name="surnom" required>
          </div>

          <div class="form-group">
            <label for="motDePasse">Mot de passe:</label>
            <input type="password" id="motDePasse" name="motDePasse" required>
          </div>

          <button type="submit" class="btn">Se connecter</button>
        </form>

        <div class="test-accounts">
          <h4>Comptes de test:</h4>
          <p><strong>admin</strong> / admin123 (Administrateur)</p>
          <p><strong>marie</strong> / marie123 (Caissi√®re)</p>
          <p><strong>jean</strong> / jean123 (Agent terrain)</p>
        </div>
  </div>
</body>

</html>

<!-- =============================================== -->
<!-- FICHIER: views/dashboard.ejs -->
<!-- =============================================== -->
<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tableau de bord - Soakoja</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <nav class="navbar">
    <div class="nav-brand">
      <h2>üö∞ SOAKOJA</h2>
    </div>
    <div class="nav-user">
      <span>Bonjour <%= employe.prenom %>
          <%= employe.nom %> (<%= employe.Poste.nomPoste %>)</span>
      <a href="/logout" class="btn btn-sm">D√©connexion</a>
    </div>
  </nav>

  <div class="container">
    <div class="page-header">
      <h1>üìä Tableau de bord</h1>
      <p>Base: <%= employe.Base.nom %>
      </p>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">üìã</div>
        <div class="stat-content">
          <h3>
            <%= stats.plannings %>
          </h3>
          <p>Plannings</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">üèóÔ∏è</div>
        <div class="stat-content">
          <h3>
            <%= stats.ouvrages %>
          </h3>
          <p>Ouvrages</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">üíß</div>
        <div class="stat-content">
          <h3>
            <%= stats.pointsEau %>
          </h3>
          <p>Points d'eau</p>
        </div>
      </div>
    </div>

    <div class="menu-grid">
      <a href="/plannings" class="menu-card">
        <div class="menu-icon">üìã</div>
        <h3>Plannings</h3>
        <p>Saisie et suivi des activit√©s</p>
      </a>

      <% if (niveauMenu>= 2) { %>
        <a href="/paiements-forfaitaires" class="menu-card">
          <div class="menu-icon">üí∞</div>
          <h3>Paiements forfaitaires</h3>
          <p>Gestion des paiements trimestriels</p>
        </a>
        <% } %>

          <a href="/points-eau" class="menu-card">
            <div class="menu-icon">üöø</div>
            <h3>Points d'eau</h3>
            <p>Gestion des branchements</p>
          </a>

          <a href="/releves" class="menu-card">
            <div class="menu-icon">üìä</div>
            <h3>Relev√©s</h3>
            <p>Saisie relev√©s compteurs</p>
          </a>

          <a href="/cartes-sociales" class="menu-card">
            <div class="menu-icon">üé´</div>
            <h3>Cartes sociales</h3>
            <p>Gestion tarifs pr√©f√©rentiels</p>
          </a>

          <% if (niveauMenu>= 2) { %>
            <a href="/achats-stocks" class="menu-card">
              <div class="menu-icon">üì¶</div>
              <h3>Achats & Stocks</h3>
              <p>Gestion des approvisionnements</p>
            </a>
            <% } %>

              <% if (niveauMenu>= 4) { %>
                <a href="/admin" class="menu-card">
                  <div class="menu-icon">‚öôÔ∏è</div>
                  <h3>Administration</h3>
                  <p>Configuration syst√®me</p>
                </a>
                <% } %>

                  <% if (niveauMenu>= 3) { %>
                    <a href="/diamex" class="menu-card">
                      <div class="menu-icon">üîÑ</div>
                      <h3>Charge DiameX</h3>
                      <p>Synchronisation comptable</p>
                    </a>
                    <% } %>
    </div>
  </div>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f5;
    }

    .navbar {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .nav-brand h2 {
      margin: 0;
      font-size: 1.5rem;
    }

    .nav-user {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .btn {
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      text-decoration: none;
      border-radius: 5px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: background 0.3s;
    }

    .btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .page-header {
      margin-bottom: 2rem;
    }

    .page-header h1 {
      margin: 0;
      color: #333;
      font-size: 2.5rem;
    }

    .page-header p {
      margin: 0.5rem 0 0 0;
      color: #666;
      font-size: 1.1rem;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .stat-card {
      background: white;
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .stat-icon {
      font-size: 2.5rem;
    }

    .stat-content h3 {
      margin: 0;
      font-size: 2rem;
      color: #333;
    }

    .stat-content p {
      margin: 0.25rem 0 0 0;
      color: #666;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .menu-card {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      text-decoration: none;
      color: #333;
      transition: transform 0.3s, box-shadow 0.3s;
      text-align: center;
    }

    .menu-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    }

    .menu-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .menu-card h3 {
      margin: 0 0 0.5rem 0;
      color: #333;
    }

    .menu-card p {
      margin: 0;
      color: #666;
      font-size: 0.9rem;
    }
  </style>
</body>

</html>

<!-- =============================================== -->
<!-- FICHIER: views/plannings/liste.ejs -->
<!-- =============================================== -->
<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plannings - Soakoja</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <nav class="navbar">
    <div class="nav-brand">
      <h2>üö∞ SOAKOJA</h2>
    </div>
    <div class="nav-user">
      <a href="/dashboard" class="btn btn-sm">‚Üê Tableau de bord</a>
      <a href="/logout" class="btn btn-sm">D√©connexion</a>
    </div>
  </nav>

  <div class="container">
    <div class="page-header">
      <h1>üìã Gestion des Plannings</h1>
      <div class="header-actions">
        <a href="/plannings/nouveau" class="btn btn-primary">+ Nouveau Planning</a>
      </div>
    </div>

    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th>Date</th>
            <th>Employ√©</th>
            <th>Ouvrage</th>
            <th>Activit√©</th>
            <th>Statut</th>
            <th>D√©bit</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% plannings.forEach(planning=> { %>
            <tr>
              <td>
                <%= new Date(planning.date).toLocaleDateString('fr-FR') %>
              </td>
              <td>
                <%= planning.Employe.prenom %>
                  <%= planning.Employe.nom %>
              </td>
              <td>
                <%= planning.Ouvrage.nom %>
              </td>
              <td>
                <%= planning.Activite.nom %>
              </td>
              <td>
                <span class="status <%= planning.estValide ? 'validated' : 'pending' %>">
                  <%= planning.estValide ? '‚úÖ Valid√©' : '‚è≥ En attente' %>
                </span>
              </td>
              <td>
                <%= planning.debitMesure ? planning.debitMesure + ' L/min' : '-' %>
              </td>
              <td>
                <% if (!planning.estValide && niveauMenu>= 3) { %>
                  <button onclick="validerPlanning(<%= planning.id %>)" class="btn btn-sm btn-success">Valider</button>
                  <% } %>
                    <a href="/plannings/<%= planning.id %>/details" class="btn btn-sm">D√©tails</a>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>

      <% if (plannings.length===0) { %>
        <div class="empty-state">
          <p>Aucun planning trouv√©</p>
          <a href="/plannings/nouveau" class="btn btn-primary">Cr√©er le premier planning</a>
        </div>
        <% } %>
    </div>
  </div>

  <style>
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
    }

    .btn-success {
      background: #28a745;
      color: white;
      border: none;
    }

    .table-container {
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th {
      background: #f8f9fa;
      padding: 1rem;
      text-align: left;
      font-weight: bold;
      border-bottom: 2px solid #dee2e6;
    }

    .data-table td {
      padding: 1rem;
      border-bottom: 1px solid #dee2e6;
    }

    .data-table tr:hover {
      background: #f8f9fa;
    }

    .status {
      padding: 0.25rem 0.75rem;
      border-radius: 15px;
      font-size: 0.875rem;
      font-weight: bold;
    }

    .status.validated {
      background: #d4edda;
      color: #155724;
    }

    .status.pending {
      background: #fff3cd;
      color: #856404;
    }

    .empty-state {
      text-align: center;
      padding: 3rem;
      color: #666;
    }

    .btn-sm {
      padding: 0.25rem 0.75rem;
      font-size: 0.875rem;
    }
  </style>

  <script>
    async function validerPlanning(id) {
      if (!confirm('Confirmer la validation de ce planning ?')) return;

      try {
        const response = await fetch(`/plannings/${id}/valider`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          }
        });

        if (response.ok) {
          location.reload();
        } else {
          alert('Erreur lors de la validation');
        }
      } catch (error) {
        alert('Erreur de connexion');
      }
    }
  </script>
</body>

</html>

<!-- =============================================== -->
<!-- FICHIER: views/plannings/nouveau.ejs -->
<!-- =============================================== -->
<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nouveau Planning - Soakoja</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <nav class="navbar">
    <div class="nav-brand">
      <h2>üö∞ SOAKOJA</h2>
    </div>
    <div class="nav-user">
      <a href="/plannings" class="btn btn-sm">‚Üê Retour Plannings</a>
      <a href="/logout" class="btn btn-sm">D√©connexion</a>
    </div>
  </nav>

  <div class="container">
    <div class="page-header">
      <h1>‚ûï Nouveau Planning</h1>
    </div>

    <div class="form-container">
      <form method="POST" action="/plannings/nouveau">
        <div class="form-grid">
          <div class="form-group">
            <label for="date">Date *</label>
            <input type="date" id="date" name="date" required value="<%= new Date().toISOString().split('T')[0] %>">
          </div>

          <div class="form-group">
            <label for="employeId">Employ√© *</label>
            <select id="employeId" name="employeId" required>
              <option value="">-- S√©lectionner un employ√© --</option>
              <% employes.forEach(employe=> { %>
                <option value="<%= employe.id %>">
                  <%= employe.prenom %>
                    <%= employe.nom %> (<%= employe.Poste.nomPoste %>)
                </option>
                <% }) %>
            </select>
          </div>

          <div class="form-group">
            <label for="ouvrageId">Ouvrage *</label>
            <select id="ouvrageId" name="ouvrageId" required>
              <option value="">-- S√©lectionner un ouvrage --</option>
              <% ouvrages.forEach(ouvrage=> { %>
                <option value="<%= ouvrage.id %>">
                  <%= ouvrage.nom %>
                </option>
                <% }) %>
            </select>
          </div>

          <div class="form-group">
            <label for="activiteId">Activit√© *</label>
            <select id="activiteId" name="activiteId" required>
              <option value="">-- S√©lectionner une activit√© --</option>
              <% activites.forEach(activite=> { %>
                <option value="<%= activite.id %>">
                  <%= activite.nom %> (<%= activite.TypeActivite.nomType %>)
                </option>
                <% }) %>
            </select>
          </div>

          <div class="form-group">
            <label for="debitMesure">D√©bit mesur√© (L/min)</label>
            <input type="number" id="debitMesure" name="debitMesure" step="0.1" min="0" placeholder="Ex: 15.5">
          </div>

          <div class="form-group full-width">
            <label for="remarque">Remarque</label>
            <textarea id="remarque" name="remarque" rows="3" placeholder="Observations, commentaires..."></textarea>
          </div>
        </div>

        <div class="form-actions">
          <span id="autosave-status"
            style="color: var(--text-muted, #666); font-style: italic; margin-right: auto; transition: opacity 0.5s ease;"></span>
          <a href="/plannings" class="btn btn-cancel">Annuler</a>
          <button type="submit" class="btn btn-primary">Cr√©er le planning</button>
        </div>
      </form>
    </div>
  </div>

  <style>
    .form-container {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    label {
      margin-bottom: 0.5rem;
      font-weight: bold;
      color: #333;
    }

    input,
    select,
    textarea {
      padding: 0.75rem;
      border: 2px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
      font-family: inherit;
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #667eea;
    }

    textarea {
      resize: vertical;
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 1px solid #eee;
    }

    .btn-cancel {
      background: #6c757d;
      color: white;
      text-decoration: none;
    }

    .btn-cancel:hover {
      background: #5a6268;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const form = document.querySelector('form[action="/plannings/nouveau"]');
      if (!form) return;

      const formId = 'autosave_planning_form';
      const formElements = form.elements;
      const statusElement = document.getElementById('autosave-status');

      // Fonction pour sauvegarder les donn√©es du formulaire dans le localStorage
      const saveForm = () => {
        const data = {};
        for (const element of formElements) {
          if (element.name) {
            data[element.name] = element.value;
          }
        }
        localStorage.setItem(formId, JSON.stringify(data));

        if (statusElement) {
          statusElement.textContent = 'Brouillon sauvegard√©.';
          statusElement.style.opacity = '1';
          setTimeout(() => {
            if (statusElement) statusElement.style.opacity = '0';
          }, 2500);
        }
      };

      // Fonction pour charger les donn√©es depuis le localStorage
      const loadForm = () => {
        const savedData = localStorage.getItem(formId);
        if (savedData) {
          const data = JSON.parse(savedData);
          for (const key in data) {
            if (form.elements[key]) {
              form.elements[key].value = data[key];
            }
          }
        }
      };

      // Fonction pour effacer les donn√©es sauvegard√©es
      const clearSavedData = () => localStorage.removeItem(formId);

      // Ajout des √©couteurs d'√©v√©nements
      form.addEventListener('input', saveForm);
      form.addEventListener('submit', clearSavedData);
      document.querySelector('.btn-cancel').addEventListener('click', clearSavedData);

      // Charger les donn√©es au chargement de la page
      loadForm();
    });
  </script>
</body>

</html>

<!-- =============================================== -->
<!-- FICHIER: views/points-eau/liste.ejs -->
<!-- =============================================== -->
<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Points d'eau - Soakoja</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <nav class="navbar">
    <div class="nav-brand">
      <h2>üö∞ SOAKOJA</h2>
    </div>
    <div class="nav-user">
      <a href="/dashboard" class="btn btn-sm">‚Üê Tableau de bord</a>
      <a href="/logout" class="btn btn-sm">D√©connexion</a>
    </div>
  </nav>

  <div class="container">
    <div class="page-header">
      <h1>üöø Points d'eau</h1>
      <div class="header-actions">
        <a href="/points-eau/nouveau" class="btn btn-primary">+ Nouveau Point d'eau</a>
      </div>
    </div>

    <div class="filters">
      <input type="text" id="searchFilter" placeholder="üîç Rechercher par nom abonn√©..." onkeyup="filterTable()">
      <select id="typeFilter" onchange="filterTable()">
        <option value="">Tous les types</option>
        <option value="Kiosque">Kiosque</option>
        <option value="Branchement priv√©">Branchement priv√©</option>
      </select>
    </div>

    <div class="table-container">
      <table class="data-table" id="pointsEauTable">
        <thead>
          <tr>
            <th>Abonn√©</th>
            <th>Type</th>
            <th>Ouvrage</th>
            <th>Localisation</th>
            <th>Date branchement</th>
            <th>Tarif forfaitaire</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% pointsEau.forEach(point=> { %>
            <tr>
              <td>
                <strong>
                  <%= point.nomAbonne || 'Non d√©fini' %>
                </strong>
                <br><small>
                  <%= point.contactAbonne || '' %>
                </small>
              </td>
              <td>
                <span class="type-badge <%= point.TypePointEau.categoriePointEau.toLowerCase() %>">
                  <%= point.TypePointEau.nomType %>
                </span>
              </td>
              <td>
                <%= point.Ouvrage.nom %>
              </td>
              <td>
                <%= point.Parcelle.Village.nom %>,
                  <%= point.Parcelle.Village.Commune.nom %>
              </td>
              <td>
                <%= point.dateBranchement ? new Date(point.dateBranchement).toLocaleDateString('fr-FR') : 'Non branch√©'
                  %>
              </td>
              <td>
                <%= point.tarifForfaitaire ? point.tarifForfaitaire + ' Ar' : '-' %>
              </td>
              <td>
                <span class="status <%= point.dateArretBranchement ? 'inactive' : 'active' %>">
                  <%= point.dateArretBranchement ? 'üî¥ Arr√™t√©' : 'üü¢ Actif' %>
                </span>
              </td>
              <td>
                <a href="/points-eau/<%= point.id %>" class="btn btn-sm">Voir</a>
                <% if (!point.dateBranchement) { %>
                  <a href="/demandes-bp/<%= point.id %>" class="btn btn-sm btn-warning">
                    Demande BP
                  </a>
                  <% } %>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>

      <% if (pointsEau.length===0) { %>
        <div class="empty-state">
          <p>Aucun point d'eau trouv√©</p>
          <a href="/points-eau/nouveau" class="btn btn-primary">Cr√©er le premier point d'eau</a>
        </div>
        <% } %>
    </div>
  </div>

  <style>
    .filters {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .filters input,
    .filters select {
      padding: 0.75rem;
      border: 2px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
    }

    .filters input {
      flex: 1;
      min-width: 300px;
    }

    .type-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 15px;
      font-size: 0.875rem;
      font-weight: bold;
    }

    .type-badge.public {
      background: #cfe2ff;
      color: #084298;
    }

    .type-badge.priv√© {
      background: #f8d7da;
      color: #721c24;
    }

    .status.active {
      background: #d1e7dd;
      color: #0f5132;
    }

    .status.inactive {
      background: #f8d7da;
      color: #721c24;
    }

    .btn-warning {
      background: #ffc107;
      color: #000;
      border: none;
    }

    .data-table td {
      vertical-align: top;
    }

    .data-table small {
      color: #666;
    }
  </style>

  <script>
    function filterTable() {
      const searchValue = document.getElementById('searchFilter').value.toLowerCase();
      const typeValue = document.getElementById('typeFilter').value;
      const table = document.getElementById('pointsEauTable');
      const rows = table.querySelectorAll('tbody tr');

      rows.forEach(row => {
        const abonne = row.cells[0].textContent.toLowerCase();
        const type = row.cells[1].textContent.trim();

        const matchSearch = abonne.includes(searchValue);
        const matchType = !typeValue || type.includes(typeValue);

        row.style.display = matchSearch && matchType ? '' : 'none';
      });
    }
  </script>
</body>

</html>

<!-- =============================================== -->
<!-- FICHIER: views/cartes-sociales/liste.ejs -->
<!-- =============================================== -->
<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cartes Sociales - Soakoja</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <nav class="navbar">
    <div class="nav-brand">
      <h2>üö∞ SOAKOJA</h2>
    </div>
    <div class="nav-user">
      <a href="/dashboard" class="btn btn-sm">‚Üê Tableau de bord</a>
      <a href="/logout" class="btn btn-sm">D√©connexion</a>
    </div>
  </nav>

  <div class="container">
    <div class="page-header">
      <h1>üé´ Cartes Sociales</h1>
      <div class="header-actions">
        <a href="/cartes-sociales/nouvelle" class="btn btn-primary">+ Nouvelle Carte</a>
        <a href="/cartes-sociales/consommations" class="btn btn-secondary">
          üìä Saisir Consommations
        </a>
      </div>
    </div>

    <div class="info-box">
      <h3>‚ÑπÔ∏è Tarification Cartes Sociales</h3>
      <p><strong>100 Ar</strong> = 30 bidons de 20L (soit 600L d'eau)</p>
    </div>

    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th>B√©n√©ficiaire</th>
            <th>Point d'eau</th>
            <th>Ouvrage</th>
            <th>Localisation</th>
            <th>Derni√®re consommation</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% cartesSociales.forEach(carte=> { %>
            <tr>
              <td>
                <strong>
                  <%= carte.nomBeneficiaire %>
                </strong>
                <br><span class="badge-social">üé´ Carte Sociale</span>
              </td>
              <td>
                <%= carte.PointEau.nomAbonne %>
              </td>
              <td>
                <%= carte.PointEau.Ouvrage.nom %>
              </td>
              <td>
                <% if (carte.PointEau.Parcelle) { %>
                  <%= carte.PointEau.Parcelle.Village.nom %>,
                    <%= carte.PointEau.Parcelle.Village.Commune.nom %>
                      <% } else { %>
                        Localisation non d√©finie
                        <% } %>
              </td>
              <td>
                <span class="date-info">En cours d'impl√©mentation</span>
              </td>
              <td>
                <a href="/cartes-sociales/<%= carte.id %>/consommation" class="btn btn-sm btn-primary">+
                  Consommation</a>
                <a href="/cartes-sociales/<%= carte.id %>" class="btn btn-sm">D√©tails</a>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>

      <% if (cartesSociales.length===0) { %>
        <div class="empty-state">
          <h3>üé´ Aucune carte sociale</h3>
          <p>Cr√©ez la premi√®re carte sociale pour les b√©n√©ficiaires</p>
          <a href="/cartes-sociales/nouvelle" class="btn btn-primary">
            Cr√©er une carte sociale
          </a>
        </div>
        <% } %>
    </div>
  </div>

  <style>
    .info-box {
      background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
      padding: 1.5rem;
      border-radius: 10px;
      margin-bottom: 2rem;
      border-left: 4px solid #667eea;
    }

    .info-box h3 {
      margin: 0 0 0.5rem 0;
      color: #333;
    }

    .info-box p {
      margin: 0;
      color: #555;
    }

    .badge-social {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 15px;
      font-size: 0.75rem;
      font-weight: bold;
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
      text-decoration: none;
      border: none;
    }

    .btn-secondary:hover {
      background: #5a6268;
      transform: translateY(-2px);
    }

    .date-info {
      color: #666;
      font-style: italic;
      font-size: 0.9rem;
    }

    .header-actions {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    @media (max-width: 768px) {
      .header-actions {
        width: 100%;
        margin-top: 1rem;
      }

      .page-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</body>

</html>

<!-- =============================================== -->
<!-- FICHIER: views/admin/index.ejs -->
<!-- =============================================== -->
<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Administration - Soakoja</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <nav class="navbar">
    <div class="nav-brand">
      <h2>üö∞ SOAKOJA</h2>
    </div>
    <div class="nav-user">
      <a href="/dashboard" class="btn btn-sm">‚Üê Tableau de bord</a>
      <a href="/logout" class="btn btn-sm">D√©connexion</a>
    </div>
  </nav>

  <div class="container">
    <div class="page-header">
      <h1>‚öôÔ∏è Administration</h1>
      <p>Gestion des param√®tres syst√®me</p>
    </div>

    <div class="admin-grid">
      <div class="admin-section">
        <h3>üë• Gestion des Employ√©s</h3>
        <div class="admin-stats">
          <div class="stat">
            <span class="number">
              <%= stats.employes %>
            </span>
            <span class="label">Employ√©s</span>
          </div>
        </div>
        <div class="admin-actions">
          <a href="/admin/employes" class="btn btn-primary">G√©rer les employ√©s</a>
          <a href="/admin/postes" class="btn btn-secondary">G√©rer les postes</a>
        </div>
      </div>

      <div class="admin-section">
        <h3>üè¢ Gestion des Bases</h3>
        <div class="admin-stats">
          <div class="stat">
            <span class="number">
              <%= stats.bases %>
            </span>
            <span class="label">Bases</span>
          </div>
        </div>
        <div class="admin-actions">
          <a href="/admin/bases" class="btn btn-primary">G√©rer les bases</a>
          <a href="/admin/organisations" class="btn btn-secondary">G√©rer les organisations</a>
        </div>
      </div>

      <div class="admin-section">
        <h3>üèóÔ∏è Gestion des Ouvrages</h3>
        <div class="admin-stats">
          <div class="stat">
            <span class="number">
              <%= stats.ouvrages %>
            </span>
            <span class="label">Ouvrages</span>
          </div>
        </div>
        <div class="admin-actions">
          <a href="/admin/ouvrages" class="btn btn-primary">G√©rer les ouvrages</a>
          <a href="/admin/types-ouvrages" class="btn btn-secondary">Types d'ouvrages</a>
        </div>
      </div>

      <div class="admin-section">
        <h3>üìã Donn√©es d'Activit√©s</h3>
        <div class="admin-stats">
          <div class="stat">
            <span class="number">
              <%= stats.plannings %>
            </span>
            <span class="label">Plannings</span>
          </div>
        </div>
        <div class="admin-actions">
          <a href="/admin/activites" class="btn btn-primary">G√©rer les activit√©s</a>
          <a href="/admin/designations" class="btn btn-secondary">G√©rer les d√©signations</a>
        </div>
      </div>

      <div class="admin-section">
        <h3>üó∫Ô∏è Donn√©es G√©ographiques</h3>
        <div class="admin-actions">
          <a href="/admin/regions" class="btn btn-primary">G√©rer les r√©gions</a>
          <a href="/admin/districts" class="btn btn-secondary">G√©rer les districts</a>
          <a href="/admin/communes" class="btn btn-secondary">G√©rer les communes</a>
          <a href="/admin/villages" class="btn btn-secondary">G√©rer les villages</a>
        </div>
      </div>

      <div class="admin-section">
        <h3>üîß Syst√®me</h3>
        <div class="admin-actions">
          <a href="/admin/backup" class="btn btn-warning">üíæ Sauvegarde</a>
          <a href="/admin/logs" class="btn btn-info">üìä Logs syst√®me</a>
          <a href="/admin/settings" class="btn btn-secondary">‚öôÔ∏è Param√®tres</a>
        </div>
      </div>
    </div>
  </div>

  <style>
    .admin-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 2rem;
    }

    .admin-section {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    }

    .admin-section h3 {
      margin: 0 0 1.5rem 0;
      color: #333;
      font-size: 1.25rem;
    }

    .admin-stats {
      margin-bottom: 1.5rem;
    }

    .stat {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 1rem;
      background: #f8f9fa;
      border-radius: 8px;
    }

    .stat .number {
      font-size: 2rem;
      font-weight: bold;
      color: #667eea;
    }

    .stat .label {
      color: #666;
      font-size: 0.9rem;
      margin-top: 0.25rem;
    }

    .admin-actions {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .admin-actions .btn {
      text-align: center;
      text-decoration: none;
      transition: all 0.3s;
    }

    .btn-info {
      background: #17a2b8;
      color: white;
      border: none;
    }

    .btn-warning {
      background: #ffc107;
      color: #000;
      border: none;
    }

    .admin-actions .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
  </style>
</body>

</html>